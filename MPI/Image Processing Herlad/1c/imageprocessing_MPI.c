#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <GL/glut.h>
#include <GL/gl.h>
#include <malloc.h>
#include <signal.h>
#include <mpi.h>
#include <unistd.h>
/*
To compile:
mpicc -o ip imageprocessing_MPI.c -lglut -lGL -lm

To run:
mpirun -n 5 ./ip
*/

#define width 100 
#define height 72

unsigned char image[], results[width * height];
int startIndex, endIndex;
void edges(unsigned char *in, unsigned char *out) {
  int i;
  int pixels = width * height;

  for(i=0;i<pixels;i++) {
    int x, y; // the pixel of interest
    int b, d, f, h; // the pixels adjacent to x,y used for the calculation
    int r; // the result of calculate
    
    y = i / width;
    x = i - (width * y);

    if (x == 0 || y == 0 || x == width - 1 || y == height - 1) {
      results[i] = 0;
    } else {
      b = i + width;
      d = i - 1;
      f = i + 1;
      h = i - width;

      r = (in[i] * 4) + (in[b] * -1) + (in[d] * -1) + (in[f] * -1)
          + (in[h] * -1);

      if (r > 0) { // if the result is positive this is an edge pixel
        out[i] = 255;
      } else {
        out[i] = 0;
      }
    }
  }
}

void tidy_and_exit() {
  exit(0);
}

void sigint_callback(int signal_number){
  printf("\nInterrupt from keyboard\n");
  tidy_and_exit();
}

static void show() {
  glClear(GL_COLOR_BUFFER_BIT);
  glRasterPos4i(-1, -1, 0, 1);
  glDrawPixels(width, height, GL_LUMINANCE, GL_UNSIGNED_BYTE, image);
  glRasterPos4i(0, -1, 0, 1);
  glDrawPixels(width, height, GL_LUMINANCE, GL_UNSIGNED_BYTE, results);
  glFlush();
}

static void key_pressed(unsigned char key, int x, int y) {
  switch(key){
    case 27: // escape
      tidy_and_exit();
      break;
    default: 
      printf("\nPress escape to exit\n");
      break;
  }
}
int time_difference(struct timespec *start, struct timespec *finish, 
                    long long int *difference) {
  long long int ds =  finish->tv_sec - start->tv_sec; 
  long long int dn =  finish->tv_nsec - start->tv_nsec; 

  if(dn < 0 ) {
    ds--;
    dn += 1000000000; 
  } 
  *difference = ds * 1000000000 + dn;
  return !(*difference > 0);
}

int main(int argc, char **argv) {
  signal(SIGINT, sigint_callback);

int size, rank;
	

  MPI_Init(NULL, NULL);
  MPI_Comm_size(MPI_COMM_WORLD, &size);
  MPI_Comm_rank(MPI_COMM_WORLD, &rank);
  if(size != 5) {
    if(rank == 0) {
      printf("This program needs to run on exactly 5 processes\n");
    }
}
	else{
	if(rank == 0) {
	struct timespec start, finish;   
  long long int time_elapsed;

  clock_gettime(CLOCK_MONOTONIC, &start);
 MPI_Send(&results[0], 1800, MPI_UNSIGNED_CHAR, 1, 0, MPI_COMM_WORLD);
MPI_Send(&results[1800], 1800, MPI_UNSIGNED_CHAR, 2, 0, MPI_COMM_WORLD);
MPI_Send(&results[3600], 1800, MPI_UNSIGNED_CHAR, 3, 0, MPI_COMM_WORLD);
MPI_Send(&results[5400], 1800, MPI_UNSIGNED_CHAR, 4, 0, MPI_COMM_WORLD);

MPI_Recv(&results[0], 1800, MPI_UNSIGNED_CHAR, 1, 0, MPI_COMM_WORLD,MPI_STATUS_IGNORE);
MPI_Recv(&results[1800], 1800, MPI_UNSIGNED_CHAR, 2, 0, MPI_COMM_WORLD,MPI_STATUS_IGNORE);
MPI_Recv(&results[3600], 1800, MPI_UNSIGNED_CHAR, 3, 0, MPI_COMM_WORLD,MPI_STATUS_IGNORE);
MPI_Recv(&results[5400], 1800, MPI_UNSIGNED_CHAR, 4, 0, MPI_COMM_WORLD,MPI_STATUS_IGNORE);

  clock_gettime(CLOCK_MONOTONIC, &finish);
  time_difference(&start, &finish, &time_elapsed);
  printf("Time elapsed was %lldns or %0.9lfs\n", time_elapsed, 
         (time_elapsed/1.0e9)); 
 
  glutInit(&argc, argv);
  glutInitWindowSize(width * 2,height);
  glutInitDisplayMode(GLUT_SINGLE | GLUT_LUMINANCE);
      
  glutCreateWindow("6CS005 Image Progessing Courework");
  glutDisplayFunc(show);
  glutKeyboardFunc(key_pressed);
  glClearColor(0.0, 1.0, 0.0, 1.0); 

  glutMainLoop(); 

  tidy_and_exit();
}else{
if(rank==1){
	startIndex=0;
	  endIndex=1799;
	MPI_Recv(&results[0], 1800, MPI_UNSIGNED_CHAR, 0, 0, MPI_COMM_WORLD,MPI_STATUS_IGNORE);
	edges(image,results);
	 MPI_Send(&results[0], 1800, MPI_UNSIGNED_CHAR, 0, 0, MPI_COMM_WORLD);
}
else if(rank==2){
	startIndex=1800;
	  endIndex=3599;
	MPI_Recv(&results[1800], 1800, MPI_UNSIGNED_CHAR, 0, 0, MPI_COMM_WORLD,MPI_STATUS_IGNORE);
	edges(image,results);
	 MPI_Send(&results[1800], 1800, MPI_UNSIGNED_CHAR, 0, 0, MPI_COMM_WORLD);
}
else if(rank==3){
	startIndex=3600;
	  endIndex=5399;
	MPI_Recv(&results[3600], 1800, MPI_UNSIGNED_CHAR, 0, 0, MPI_COMM_WORLD,MPI_STATUS_IGNORE);
	edges(image,results);
	 MPI_Send(&results[3600], 1800, MPI_UNSIGNED_CHAR, 0, 0, MPI_COMM_WORLD);
}
else if(rank==4){
	startIndex=5400;
	  endIndex=7199;
	MPI_Recv(&results[5400], 1800, MPI_UNSIGNED_CHAR, 0, 0, MPI_COMM_WORLD,MPI_STATUS_IGNORE);
	edges(image,results);
	 MPI_Send(&results[5400], 1800, MPI_UNSIGNED_CHAR, 0, 0, MPI_COMM_WORLD);
}

}
}
  MPI_Finalize();
  return 0;

}


unsigned char image[] = {255,255,255,255,255,255,255,255,0,0,255,255,0,0,0,0,0,0,
  0,0,0,0,0,255,255,0,0,0,0,0,255,0,0,255,255,0,0,
  255,0,0,0,255,0,0,255,255,0,0,0,255,255,255,255,255,255,255,
  255,255,255,255,0,0,0,255,255,0,0,255,255,255,0,0,255,0,0,
  0,0,0,0,255,255,0,0,255,255,255,255,255,255,255,255,255,255,255,
  0,0,0,0,0,0,0,255,255,255,0,0,255,255,0,0,255,0,0,
  0,0,0,0,0,0,0,0,0,0,0,255,0,0,255,0,0,255,0,
  0,255,255,0,0,255,0,0,0,255,0,0,255,255,0,0,0,255,255,
  255,255,255,255,255,255,255,255,255,255,0,0,0,255,255,0,255,255,255,
  0,0,255,0,0,0,255,255,0,255,255,0,0,0,255,0,255,255,255,
  255,255,255,255,255,255,0,0,0,0,0,0,0,255,255,0,0,255,0,
  0,0,255,0,0,0,0,0,0,255,0,0,255,255,0,0,255,0,255,
  255,0,0,255,255,0,0,255,0,0,0,0,0,0,255,255,0,0,255,
  0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,255,
  255,0,0,255,255,0,0,255,0,0,0,255,255,0,0,255,0,0,0,
  0,0,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,
  255,0,0,255,0,0,0,255,0,0,255,255,0,0,0,255,0,255,255,
  0,0,255,255,255,0,0,0,255,255,0,0,255,0,0,0,0,0,0,
  255,255,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,0,0,255,255,0,0,0,0,0,0,255,255,0,0,255,255,0,
  0,255,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,0,
  0,0,0,0,0,255,0,0,255,0,0,0,255,0,0,255,255,0,0,
  0,255,255,255,0,0,0,255,255,0,0,0,0,255,255,0,0,255,0,
  0,0,0,0,0,0,255,0,0,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,0,0,0,0,0,0,255,0,0,0,0,0,255,255,255,
  0,0,255,255,0,0,255,255,0,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,0,0,0,255,0,0,255,0,0,0,0,0,255,255,0,
  0,255,255,255,0,0,255,255,0,0,0,0,255,255,0,0,0,0,255,
  255,0,0,255,0,0,0,0,255,0,0,255,0,0,255,255,0,0,255,
  255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,255,255,0,0,
  0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,0,0,255,255,255,255,0,0,0,
  0,0,255,255,0,0,255,255,255,0,0,255,0,0,0,0,0,255,0,
  0,0,0,255,255,255,0,0,255,255,0,0,0,255,0,0,255,0,0,
  0,0,0,0,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,
  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,255,255,
  255,255,255,0,0,0,0,0,255,0,0,255,255,255,0,0,255,0,0,
  0,255,255,255,0,0,0,255,0,0,255,0,0,255,255,0,0,0,255,
  0,0,255,255,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,
  0,0,0,255,255,255,255,255,0,0,0,0,0,255,0,0,0,255,255,
  0,0,255,0,0,255,255,0,255,0,0,0,255,0,0,255,0,0,255,
  255,0,0,255,255,0,0,255,255,255,0,0,0,0,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,0,0,0,0,0,255,255,255,255,255,0,0,255,255,0,0,
  0,0,0,255,255,0,0,255,0,0,255,0,0,0,255,0,0,0,0,
  0,255,0,0,255,255,0,0,255,255,255,0,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,0,0,0,0,0,0,255,255,0,255,255,0,
  0,255,255,0,0,255,0,0,0,0,0,0,255,0,0,0,0,0,255,
  255,0,0,0,0,0,255,255,0,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,255,
  255,0,0,255,0,0,0,0,0,0,255,0,0,0,0,0,0,255,255,
  0,0,0,0,255,255,255,0,0,0,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,0,0,
  0,0,0,0,0,0,0,0,255,0,0,0,0,0,0,255,255,0,0,
  0,0,255,255,255,255,0,0,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,
  255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,0,0,255,255,255,255,255,255,255,255,255,255,0,0,0,0,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,255,255,255,255,
  0,255,255,255,255,255,255,255,255,255,255,0,0,0,0,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,0,0,255,0,0,255,0,
  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,
  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,0,0,0,255,255,0,0,255,255,255,255,255,0,0,
  255,0,0,255,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  0,255,255,255,255,255,255,255,255,0,0,0,0,0,255,0,0,255,255,
  255,255,255,255,0,255,0,0,0,0,0,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,0,0,0,0,0,255,255,255,255,255,255,0,255,255,0,0,
  255,0,0,0,255,255,255,255,255,0,255,0,0,0,0,0,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,0,0,255,255,255,255,0,0,255,0,0,0,255,255,255,255,255,
  255,255,255,0,0,255,0,0,0,0,0,0,255,255,0,0,0,0,0,
  0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,0,255,255,0,
  0,255,255,255,255,255,255,0,0,255,255,255,0,0,255,255,255,0,0,
  255,255,255,255,255,255,0,255,0,0,255,255,0,0,255,0,0,255,255,
  0,0,0,255,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,0,0,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,0,255,255,255,255,0,0,255,0,255,
  255,0,0,255,0,0,255,255,255,255,255,255,0,0,255,255,255,0,0,
  255,255,255,0,0,255,255,255,255,255,0,0,0,0,255,255,255,0,0,
  255,255,0,255,255,0,0,0,255,255,0,0,0,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,0,0,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,0,0,0,0,0,255,0,0,0,0,0,
  0,0,255,0,255,0,0,0,255,0,0,255,255,255,255,255,255,0,0,
  0,255,255,0,0,255,255,255,0,0,255,255,255,255,255,0,0,255,255,
  255,255,255,0,0,255,0,0,255,255,0,0,0,255,255,0,0,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,255,0,
  0,0,255,255,255,255,255,255,255,255,255,255,255,0,0,255,0,0,255,
  0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,255,255,255,
  255,255,255,0,0,0,255,255,0,0,0,255,255,0,0,255,255,255,255,
  255,255,0,0,0,0,255,255,0,0,0,0,0,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,0,
  0,255,0,0,255,255,0,0,255,0,0,255,255,0,0,0,0,0,0,
  0,0,255,255,255,255,255,255,255,0,0,255,255,255,0,0,0,0,0,
  0,255,255,255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,0,0,0,0,0,0,0,0,0,255,255,255,255,255,
  255,255,255,255,0,0,255,0,0,255,255,0,0,255,0,0,255,255,0,
  0,0,0,255,0,0,0,255,255,255,255,255,0,0,0,0,0,0,255,
  0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,0,0,0,0,255,255,255,0,0,
  255,255,255,255,255,255,255,255,255,0,0,0,0,0,255,255,0,0,0,
  0,0,255,255,0,0,0,0,255,0,0,0,255,255,255,255,255,0,0,
  0,0,0,0,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,0,0,0,0,
  255,255,255,0,0,255,255,255,255,255,255,255,255,255,255,0,0,0,0,
  255,255,255,0,0,0,0,255,255,255,0,0,0,255,0,0,0,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,0,0,0,255,255,0,0,0,255,255,255,255,255,255,255,255,255,
  0,0,255,255,0,0,255,255,0,0,0,0,255,255,255,0,0,0,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,0,0,0,255,255,0,0,0,255,255,255,255,
  255,255,255,255,255,255,0,0,0,0,255,255,255,255,0,0,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,0,0,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,
  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,0,0,0,0,255,255,0,0,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,0,0,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,
  0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  0,255,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,0,0,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,0,0,255,255,255,255,255,255,255,255,
  255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,0,0,0,0,0,255,255,255,255,255,0,0,255,255,255,
  255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,
  0,0,0,0,0,0,255,255,255,0,0,0,0,0,0,255,255,255,255,
  0,0,0,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,255,255,255,
  0,0,0,255,0,0,0,0,0,0,0,0,255,0,0,0,0,0,0,
  0,255,255,255,255,0,0,0,255,255,255,255,255,255,255,255,0,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,255,255,255,255,
  0,0,255,255,255,0,0,0,255,255,0,0,0,0,0,0,0,255,0,
  0,0,255,255,0,0,255,255,255,255,0,0,0,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,0,0,255,255,255,255,255,255,255,0,0,0,0,
  0,0,255,255,255,0,0,0,255,255,0,0,0,255,255,0,0,0,255,
  255,255,255,255,0,0,0,255,255,0,0,0,255,255,255,0,0,0,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,0,0,0,0,255,255,255,255,255,255,0,0,255,255,255,255,255,255,
  255,0,0,0,0,0,0,0,255,255,0,0,0,255,255,0,0,0,255,
  255,0,0,255,255,255,255,255,255,0,0,255,255,255,0,0,0,255,255,
  255,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,255,
  255,255,255,255,255,0,0,0,0,0,255,255,255,255,255,255,0,0,0,
  255,255,255,255,255,255,0,0,0,0,0,0,0,255,255,0,0,0,255,
  255,0,0,255,255,255,0,0,255,255,255,255,255,255,255,255,255,255,0,
  0,0,0,255,255,255,255,0,0,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,255,0,
  0,0,0,0,0,0,255,255,255,0,0,0,0,0,0,0,255,255,255,
  255,255,0,0,0,255,255,255,255,255,255,0,0,255,255,255,0,0,0,
  255,255,0,0,255,0,0,0,255,255,255,0,0,0,255,255,255,255,255,
  255,255,255,0,0,0,0,0,255,255,255,255,0,0,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,0,0,255,0,0,0,255,255,255,
  0,0,0,255,0,0,0,0,0,0,0,255,255,255,0,0,0,0,0,
  0,0,0,255,255,255,255,0,0,0,255,255,255,255,255,255,0,0,255,
  255,255,0,0,0,255,255,0,0,0,0,0,0,255,255,255,0,0,0,
  0,0,0,0,255,255,255,0,0,0,0,0,0,255,255,255,255,0,0,
  255,255,255,255,255,255,255,255,255,0,0,255,255,255,255,0,0,255,255,
  0,0,255,255,255,0,0,0,255,0,0,0,0,0,0,0,0,255,255,
  0,0,0,255,255,0,0,0,255,255,255,255,0,0,0,255,255,255,255,
  255,0,0,0,255,255,255,0,0,0,255,255,0,0,0,0,0,0,255,
  255,255,0,0,0,0,0,0,0,255,255,255,0,0,0,0,0,255,255,
  255,255,255,0,0,255,255,255,255,255,255,255,255,255,0,0,0,255,255,
  0,0,0,0,255,0,0,0,255,0,0,0,0,255,255,0,0,0,0,
  0,0,0,255,255,0,0,0,255,255,0,0,0,255,255,255,255,255,0,
  0,255,255,255,255,255,0,0,0,255,255,255,255,0,0,255,255,0,0,
  0,0,0,0,0,255,255,0,0,0,0,0,0,0,255,255,0,0,0,
  0,0,255,255,255,255,255,255,0,0,0,255,255,255,255,255,255,255,255,
  0,0,0,255,255,0,0,0,0,255,0,0,0,0,0,0,0,0,255,
  255,0,0,255,255,255,0,0,255,255,0,0,0,255,255,255,0,0,255,
  255,255,255,255,0,0,0,0,0,0,255,255,0,0,255,255,255,255,0,
  0,255,255,0,0,0,0,0,0,0,255,255,0,0,0,0,0,255,255,
  255,255,0,0,0,255,255,255,255,255,255,255,255,0,0,0,255,255,255,
  255,255,255,255,255,0,0,0,255,255,0,0,0,0,255,0,0,0,0,
  0,0,0,0,255,255,0,0,255,255,255,0,0,0,255,0,0,0,255,
  255,255,0,0,255,255,255,255,255,0,0,0,0,0,0,255,255,0,0,
  255,255,255,255,0,0,255,255,0,0,0,255,255,0,0,0,255,255,0,
  0,255,255,255,255,255,255,0,0,0,255,255,0,0,255,255,0,0,0,
  0,0,0,0,0,255,255,255,255,255,255,0,0,255,255,0,0,0,0,
  255,255,0,0,0,0,0,0,0,255,255,0,0,255,255,255,0,0,0,
  255,0,0,0,255,255,255,0,0,0,255,255,255,255,0,0,0,0,0,
  0,255,255,0,0,255,255,255,255,0,0,255,255,0,0,0,255,255,0,
  0,0,255,255,0,0,255,255,255,255,255,255,0,0,0,255,255,0,0,
  255,255,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,0,255,
  255,0,0,0,0,255,255,0,0,0,255,0,0,0,255,255,0,0,0,
  255,255,0,0,0,255,0,0,0,255,255,255,0,0,0,255,255,255,255,
  0,0,0,0,0,255,255,255,0,0,0,255,255,255,0,0,255,255,0,
  0,0,255,255,0,0,0,255,255,0,0,0,255,0,0,255,255,255,0,
  0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,255,255,255,255,
  255,255,0,0,255,0,0,0,0,0,255,255,0,0,0,255,0,0,0,
  255,255,0,0,0,255,255,0,0,0,255,255,0,0,255,255,255,0,0,
  0,255,255,255,255,0,0,0,255,255,255,255,255,0,0,0,255,255,255,
  0,0,255,255,0,0,0,255,255,0,0,0,255,255,0,0,0,0,0,
  0,0,255,255,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,
  255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,255,255,255,0,
  0,255,0,0,0,255,255,0,0,0,255,255,255,0,0,255,255,0,0,
  255,255,255,0,0,0,255,255,255,255,0,0,0,255,255,255,255,255,255,
  0,0,0,255,0,0,0,255,255,255,0,0,0,0,0,0,0,255,255,
  0,0,0,0,0,0,0,255,255,255,0,0,0,0,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,
  0,255,255,255,0,0,255,0,0,0,255,255,0,0,0,255,255,255,0,
  0,255,255,0,0,0,255,255,0,0,0,255,255,255,255,0,0,0,0,
  0,0,0,255,255,0,0,0,0,0,0,0,255,255,255,0,0,0,0,
  0,0,0,255,255,0,0,0,0,0,0,0,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,
  0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,255,255,255,0,
  0,255,255,0,0,0,255,255,0,0,0,255,255,0,0,0,255,255,255,
  255,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,255,255,
  255,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,0,0,0,0,0,255,0,0,0,255,255,255,0,0,0,0,
  0,255,255,255,0,0,255,255,0,0,0,255,255,0,0,0,255,255,255,
  0,0,255,255,255,255,255,0,0,0,0,0,0,255,255,255,0,0,0,
  0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,0,0,0,0,0,255,0,0,0,255,255,
  255,0,0,0,0,0,255,255,255,0,0,0,0,0,0,0,255,255,0,
  0,0,255,255,255,0,0,255,255,255,255,255,0,0,0,0,0,0,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,255,
  0,0,0,255,255,255,0,0,0,0,0,255,255,255,0,0,0,0,0,
  0,0,255,255,0,0,0,255,255,255,0,0,0,255,255,255,255,0,0,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  0,0,0,0,255,0,0,0,255,255,255,255,0,0,0,255,255,255,255,
  0,0,0,0,0,0,255,255,255,0,0,0,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,0,0,0,255,255,0,0,0,255,255,255,255,0,0,
  0,255,255,255,255,0,0,0,0,0,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,0,0,0,255,255,255,0,0,255,
  255,255,255,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,0,0,0,255,255,0,0,0,255,
  255,255,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,
  0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,0,255,255,0,255,0,0,255,
  255,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,0,0,0,0,0,255,255,255,255,255,255,0,0,255,0,
  0,0,0,0,0,255,0,0,0,0,0,0,0,0,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
};

